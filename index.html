<!doctype html>
<html lang="en" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>2 Corinthians 13 â€” Study</title>

  <!-- PWA / App-like setup -->
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#1c4785" />

  <!-- iOS Add to Home Screen -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Bible Study" />
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png" />

  <style>
    :root{
      --primary:#1c4785;
      --accent:#969696;

      --bg:#0b1220;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.04);
      --border:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.94);
      --muted:rgba(255,255,255,.68);
      --muted2:rgba(255,255,255,.56);
      --shadow:0 18px 52px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:24px;
      --max:1040px;

      --step--1: clamp(.9rem,.86rem + .2vw,1rem);
      --step-0: clamp(1rem,.94rem + .35vw,1.12rem);
      --step-1: clamp(1.12rem,1.02rem + .55vw,1.32rem);
      --step-2: clamp(1.25rem,1.1rem + .85vw,1.6rem);
    }

    html[data-theme="light"]{
      --bg:#f6f7fb;
      --panel:rgba(17,24,39,.05);
      --panel2:rgba(17,24,39,.03);
      --border:rgba(17,24,39,.12);
      --text:rgba(17,24,39,.95);
      --muted:rgba(17,24,39,.65);
      --muted2:rgba(17,24,39,.55);
      --shadow:0 14px 36px rgba(17,24,39,.15);
    }

    @media (prefers-color-scheme: light){
      html[data-theme="auto"]{
        --bg:#f6f7fb;
        --panel:rgba(17,24,39,.05);
        --panel2:rgba(17,24,39,.03);
        --border:rgba(17,24,39,.12);
        --text:rgba(17,24,39,.95);
        --muted:rgba(17,24,39,.65);
        --muted2:rgba(17,24,39,.55);
        --shadow:0 14px 36px rgba(17,24,39,.15);
      }
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;

      /* Safe-area support (iPhone notch + home indicator) */
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);

      background:
        radial-gradient(900px 420px at 12% -10%, rgba(28,71,133,.40), transparent 62%),
        radial-gradient(900px 420px at 88% 0%, rgba(150,150,150,.22), transparent 62%),
        radial-gradient(900px 520px at 50% 110%, rgba(28,71,133,.14), transparent 62%),
        var(--bg);
      color:var(--text);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    .wrap{max-width:var(--max);margin:0 auto;padding:18px 14px 60px;}

    /* App bar */
    .appbar{
      position:sticky;top:0;z-index:50;
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      background: linear-gradient(to bottom, rgba(0,0,0,.40), rgba(0,0,0,0));
      border-bottom:1px solid var(--border);
      margin:-18px -14px 10px;
      padding:12px 0 10px;
    }
    html[data-theme="light"] .appbar{
      background: linear-gradient(to bottom, rgba(246,247,251,.95), rgba(246,247,251,0));
    }
    @media (prefers-color-scheme: light){
      html[data-theme="auto"] .appbar{
        background: linear-gradient(to bottom, rgba(246,247,251,.95), rgba(246,247,251,0));
      }
    }

    .appbar .inner{
      max-width:var(--max);
      margin:0 auto;
      padding:0 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .brand{display:flex;align-items:center;gap:10px;min-width:0}
    .mark{
      width:38px;height:38px;border-radius:14px;
      background: linear-gradient(135deg, rgba(28,71,133,.95), rgba(150,150,150,.55));
      box-shadow: var(--shadow);
    }

    .kicker{
      font-size:var(--step--1);
      color:var(--muted);
      letter-spacing:.08em;
      text-transform:uppercase;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    h1{
      margin:2px 0 0;
      font-size:var(--step-2);
      line-height:1.15;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}

    .btn{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.06);
      color:var(--text);
      border-radius:999px;
      padding:10px 12px;
      font-size:var(--step--1);
      display:inline-flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      white-space:nowrap;
      transition:transform .08s ease, background .2s ease;
    }
    .btn:hover{background:rgba(255,255,255,.1)}
    .btn:active{transform:translateY(1px)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(28,71,133,.98), rgba(28,71,133,.70));
      border-color: rgba(28,71,133,.6);
    }
    .btn.ghost{background:rgba(255,255,255,.04)}

    /* Layout */
    .grid{
      display:grid;
      grid-template-columns:1fr;
      gap:14px;
      margin-top:12px;
    }
    @media(min-width:980px){
      .grid{grid-template-columns:1.1fr .9fr;gap:16px}
    }

    .card{
      border:1px solid var(--border);
      background:var(--panel);
      border-radius:var(--radius2);
      padding:14px;
      box-shadow:var(--shadow);
    }

    .card h2{margin:0 0 10px;font-size:var(--step-1)}
    .sub{margin:-6px 0 10px;font-size:var(--step--1);color:var(--muted)}
    .divider{height:1px;background:var(--border);margin:10px 0 12px}
    .kicker2{font-size:var(--step--1);color:var(--muted);letter-spacing:.08em;text-transform:uppercase;margin-bottom:6px}

    .prose{font-size:var(--step-0)}
    .prose p{margin:0 0 10px}

    blockquote{
      margin:0;
      padding:12px;
      border-left:4px solid rgba(28,71,133,.72);
      background: rgba(28,71,133,.12);
      border-radius:14px;
    }

    textarea{
      width:100%;
      min-height:240px;
      resize:vertical;
      border-radius:var(--radius2);
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color:var(--text);
      padding:12px;
      font-size:var(--step-0);
      line-height:1.55;
      outline:none;
    }
    textarea:focus{
      border-color: rgba(28,71,133,.45);
      box-shadow:0 0 0 6px rgba(28,71,133,.14);
    }

    .small{font-size:var(--step--1);color:var(--muted2);margin-top:8px}

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: calc(18px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(0,0,0,.72);
      color:#fff;
      border:1px solid rgba(255,255,255,.12);
      padding:10px 12px;
      border-radius:999px;
      font-size:14px;
      z-index:1000;
      display:none;
      max-width:92vw;
      text-align:center;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    html[data-theme="light"] .toast{background: rgba(17,24,39,.85);}

    /* Warning banner for previewers */
    .banner{
      display:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.06);
      border-radius: var(--radius2);
      padding: 12px;
      margin: 10px 0 14px;
      color: var(--muted);
    }
  </style>
</head>

<body>
  <div class="toast" id="toast"></div>

  <div class="appbar">
    <div class="inner">
      <div class="brand">
        <div class="mark"></div>
        <div>
          <div class="kicker">Pauline Epistles</div>
          <h1>2 Corinthians 13</h1>
        </div>
      </div>
      <div class="actions">
        <button class="btn ghost" id="themeBtn" type="button">ðŸŒ“ <span id="themeLabel">Theme: Auto</span></button>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="banner" id="banner">
      If buttons donâ€™t work, you may be viewing this in a previewer (Drive/Dropbox/Files preview) that blocks downloads, clipboard, printing, or storage.
      Open this page in Safari/Chrome/Edge directly.
    </div>

    <div class="grid">
      <!-- LEFT -->
      <main class="card">
        <div class="kicker2">Logos (KJV)</div>
        <blockquote>
          <strong>2 Corinthians 13:5</strong><br>
          Examine yourselves, whether ye be in the faith; prove your own selves.
          Know ye not your own selves, how that Jesus Christ is in you,
          except ye be reprobates?
        </blockquote>

        <div class="divider"></div>

        <div class="kicker2">Chapter Summary</div>
        <div class="prose">
          <p>
            Paul concludes this letter by informing the Corinthians that he will make his third trip to Corinth to check on the church's well-being. Paul makes it clear that he is coming with the rod of rebuke, primarily intended for those who remain in the same sins he found them in on his second visit.
          </p>
          <p>
            The prayer Paul prays is that the church does not fight against his correction and that he does not need to use his God-given authority. This warning should not be mistaken as a power trip by Paul because he would gladly appear weak if it showcased that the church was, in fact, strong. Paul prefers to use his God-given authority to build up the Church, not tear them down.
          </p>
          <p>
            Paul concludes the letter with a command to be joyful, to grow in maturity, and to live in harmony with one another. "The grace of the Lord Jesus Christ, and the love of God, and the communion of the Holy Ghost, be with you all. Amen."
          </p>
        </div>

        <div class="divider"></div>

        <div class="kicker2">Chapter Breakdown</div>
        <ol>
          <li>Paulâ€™s Warning (1â€“4)</li>
          <li>Self-Examination (5â€“10)</li>
          <li>Final Remarks (11â€“14)</li>
        </ol>

        <div class="divider"></div>

        <div class="kicker2">Word of the Day</div>
        <div class="prose" style="color:var(--muted)">
          <strong>Reprobate â€” Adokimos (ad-ok'-ee-mos)</strong><br>
          which does not prove itself to be such as it ought; of sterile soil (G96)
        </div>
      </main>

      <!-- RIGHT -->
      <aside class="card">
        <h2>Notes</h2>
        <div class="sub">Your reflections</div>
        <textarea id="notes" placeholder="Write your notes here..."></textarea>

        <div class="no-print" style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
          <button class="btn" type="button" id="clearBtn">ðŸ—‘ Clear</button>
          <button class="btn" type="button" id="copyBtn">ðŸ“‹ Copy</button>
        </div>

        <div class="small" id="status">Ready.</div>
      </aside>
    </div>
  </div>

  <script>
    (function(){
      const toastEl = document.getElementById("toast");
      const bannerEl = document.getElementById("banner");
      const toast = (msg) => {
        if (!toastEl) return;
        toastEl.textContent = msg;
        toastEl.style.display = "block";
        clearTimeout(toastEl._t);
        toastEl._t = setTimeout(() => (toastEl.style.display = "none"), 2200);
      };

      // Detect storage availability (previewers often block it)
      let storageOK = true;
      try {
        const k = "__test__";
        localStorage.setItem(k, "1");
        localStorage.removeItem(k);
      } catch (e) {
        storageOK = false;
      }

      if (!storageOK) {
        if (bannerEl) bannerEl.style.display = "block";
      }

      // Theme: Auto -> Dark -> Light
      const root = document.documentElement;
      const THEME_KEY = "study_theme_pref";
      const themeBtn = document.getElementById("themeBtn");
      const themeLabel = document.getElementById("themeLabel");
      const cycle = ["auto", "dark", "light"];

      function applyTheme(t){
        root.setAttribute("data-theme", t);
        if (themeLabel) themeLabel.textContent = "Theme: " + (t[0].toUpperCase() + t.slice(1));
        if (storageOK) {
          try { localStorage.setItem(THEME_KEY, t); } catch (e) {}
        }
      }

      let initialTheme = "auto";
      if (storageOK) {
        try { initialTheme = localStorage.getItem(THEME_KEY) || "auto"; } catch (e) {}
      }
      if (!cycle.includes(initialTheme)) initialTheme = "auto";
      applyTheme(initialTheme);

      if (themeBtn) {
        themeBtn.addEventListener("click", () => {
          const cur = root.getAttribute("data-theme") || "auto";
          const next = cycle[(cycle.indexOf(cur) + 1) % cycle.length];
          applyTheme(next);
          toast("Theme: " + next);
        });
      }

      // Notes (autosave + buttons)
      const notes = document.getElementById("notes");
      const status = document.getElementById("status");
      const setStatus = (s) => { if (status) status.textContent = s; };
      const NOTES_KEY = "cor13_notes";

      if (notes && storageOK) {
        try {
          notes.value = localStorage.getItem(NOTES_KEY) || "";
        } catch (e) {}
      }

      // Autosave after pause
      let tmr = null;
      if (notes) {
        notes.addEventListener("input", () => {
          setStatus("Typingâ€¦");
          clearTimeout(tmr);
          tmr = setTimeout(() => {
            if (!storageOK) { setStatus("Autosave blocked here."); return; }
            try {
              localStorage.setItem(NOTES_KEY, notes.value || "");
              setStatus("Auto-saved âœ”");
            } catch (e) {
              setStatus("Autosave blocked here.");
            }
          }, 700);
        });
      }

      // Clear
      const clearBtn = document.getElementById("clearBtn");
      if (clearBtn && notes) {
        clearBtn.addEventListener("click", () => {
          notes.value = "";
          if (storageOK) {
            try { localStorage.removeItem(NOTES_KEY); } catch (e) {}
          }
          setStatus("Cleared.");
          toast("Cleared");
        });
      }

      // Copy (clipboard API -> fallback select)
      const copyBtn = document.getElementById("copyBtn");
      if (copyBtn && notes) {
        copyBtn.addEventListener("click", async () => {
          const text = notes.value || "";
          try {
            if (navigator.clipboard && navigator.clipboard.writeText) {
              await navigator.clipboard.writeText(text);
              setStatus("Copied âœ”");
              toast("Copied");
              return;
            }
          } catch (e) {}
          notes.focus();
          notes.select();
          setStatus("Selected notes â€” use Copy.");
          toast("Selected â€” Copy");
        });
      }

      // Register service worker (PWA offline)
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("./sw.js").catch(() => {
          // silent fail (some embeds block SW)
        });
      }
    })();
  </script>
</body>
</html>
